  <app-nav></app-nav>
  <h2> Catálogo con Productos</h2>

  <app-products
    [products]="products"
    [searchTerm]="searchTerm"
    
    (onNuevo)="abrirModalParaNuevo()"
    (onEditar)="abrirModalParaEditar($event)"
    (onEliminar)="eliminarProducto($event)"
  ></app-products>

  <!-- Modal -->
  <!-- Modal -->
  <div class="modal-backdrop" *ngIf="mostrarModal">
    <div class="modal">
      <h3 class="modal-title">
        {{ productoSeleccionado.id ? 'Editar Producto' : 'Crear Producto' }}
      </h3>
     <form (ngSubmit)="guardarProducto()" #form="ngForm" novalidate>
  <!-- Nombre -->
  <div class="form-group">
    <label for="name">Nombre</label>
    <input
      id="name"
      name="name"
      type="text"
      [(ngModel)]="productoSeleccionado.name"
      required
      minlength="3"
      maxlength="50"
      #nameCtrl="ngModel"
      autofocus
    />
    <div class="error" *ngIf="nameCtrl.invalid && nameCtrl.touched">
      <small *ngIf="nameCtrl.errors?.['required']">Nombre del Producto !Obligatorio .</small>
      <small *ngIf="nameCtrl.errors?.['minlength']">Mínimo 3 caracteres.</small>
      <small *ngIf="nameCtrl.errors?.['maxlength']">Máximo 50 caracteres.</small>
    </div>
  </div>

  <!-- Descripción -->
  <div class="form-group">
    <label for="description">Descripción</label>
    <textarea
      id="description"
      name="description"
      [(ngModel)]="productoSeleccionado.description"
      required
      minlength="5"
      maxlength="200"
      rows="3"
      #descCtrl="ngModel"
    ></textarea>
    <div class="error" *ngIf="descCtrl.invalid && descCtrl.touched">
      <small *ngIf="descCtrl.errors?.['required']">Descripción del Producto ! Obligatoria.</small>
      <small *ngIf="descCtrl.errors?.['minlength']">Mínimo 5 caracteres.</small>
      <small *ngIf="descCtrl.errors?.['maxlength']">Máximo 200 caracteres.</small>
    </div>
  </div>

  <!-- Precio -->
  <div class="form-group">
    <label for="price">Precio</label>
    <input
      id="price"
      name="price"
      type="number"
      [(ngModel)]="productoSeleccionado.price"
      required
      min="0.01"
      step="0.01"
      #priceCtrl="ngModel"
    />
    <div class="error" *ngIf="priceCtrl.invalid && priceCtrl.touched">
      <small *ngIf="priceCtrl.errors?.['required']">Precio del producto "Obligatorio".</small>
      <small *ngIf="priceCtrl.errors?.['min']">Debe ser mayor que 0.</small>
    </div>
  </div>

  <!-- Categoría -->
  <div class="form-group">
    <label for="category">Categoría</label>
    <select
      id="category"
      name="categoryid"
      [(ngModel)]="productoSeleccionado.categoryid"
      required
      #catCtrl="ngModel"
    >
      <option value="" disabled>-- Seleccione una categoría --</option>
      <option *ngFor="let cat of categories" [value]="cat.id">{{ cat.nombre }}</option>
    </select>
    <div class="error" *ngIf="catCtrl.invalid && catCtrl.touched">
      <small>Seleccione alguna categoria para continuar.</small>
    </div>
  </div>

  <!-- Botones -->
  <div class="modal-buttons">
    <button type="submit" [disabled]="form.invalid" class="btn btn-create">
      {{ productoSeleccionado.id ? 'Guardar' : 'Crear' }}
    </button>
    <button type="button" class="btn btn-cancel" (click)="cerrarModal()">Cancelar</button>
  </div>
</form>
    </div>
  </div>
